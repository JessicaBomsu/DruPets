<!DOCTYPE html>
<html lang="pt-BR">

<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>DruPets - Ado√ß√£o de Animais</title>
    <link rel="stylesheet" href="css/style.css">
    <link rel="stylesheet" href="css/footer.css">
    <link rel="stylesheet" href="css/chat.css">
    <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.4.0/css/all.min.css">
    <link rel="stylesheet" href="https://unpkg.com/leaflet@1.7.1/dist/leaflet.css" />
    <style>
        /* Estilo dos itens dentro do dropdown */
        .dropdown-content li {
            float: none;
        }

        /* Estilo para o link interno */
        .dropdown-content li a {
            color: #ffffff;
            padding: 10px 15px;
            display: block;
            text-align: left;
            white-space: nowrap;
            border-radius: 0;
            /* Garante que n√£o tenha borda */
        }

        /* Efeito hover nos links do dropdown */
        .dropdown-content li a:hover {
            background-color: rgba(255, 255, 255, 0.15);
            transform: translateY(-3px);
        }

        /* NOVO: Separador visual para agrupar links (A√ß√µes e Perfil/Sair) */
        .dropdown-content li.separator {
            height: 1px;
            background-color: rgba(255, 255, 255, 0.2);
            /* Linha divis√≥ria suave */
            margin: 5px 10px;
            /* Espa√ßamento da linha */
            padding: 0;
        }

        /* Estilo para a seta indicadora */
        .dropdown>a i {
            margin-left: 5px;
            transition: transform 0.3s;
            font-size: 0.9em;
            /* Deixa a seta um pouco menor */
        }

        /* Rotaciona a seta ao passar o mouse */
        .dropdown:hover>a i {
            transform: rotate(180deg);
        }

        /* Classe para esconder elementos */
        .hidden {
            display: none !important;
        }
    </style>
</head>

<body>
    <!-- Loader -->
    <div class="paw-loader" id="pawLoader">
        <div class="paw-spinner">üêæ</div>
        <div class="paw-loader-text">Carregando...</div>
    </div>

    <div class="chat-popup" id="chatPopup">
        <div class="chat-header">
            <h3>D√∫vidas? Fale Conosco</h3>
            <button class="chat-close" id="chatClose">√ó</button>
        </div>
        <div class="chat-messages" id="chatMessages">
        </div>

        <div class="chat-suggestions" id="chatSuggestions">
            <button class="suggestion-btn" data-question="O que √© o DruPets?">O que √© o DruPets?</button>
            <button class="suggestion-btn" data-question="Qual brinquedo ideal para cachorro?">Brinquedo para
                cachorro</button>
            <button class="suggestion-btn" data-question="Como posso adotar um pet?">Adotar um pet</button>
            <button class="suggestion-btn" data-question="Topicos?">Topicos</button>
            <button class="suggestion-btn" data-question="perdi meu animal">Perdi um animal oque fazer?</button>
        </div>
        <div class="chat-input">
            <input type="text" id="chatInput" placeholder="Digite sua mensagem e pressione Enter...">
            <button class="chat-send" id="chatSend"><i class="fas fa-paper-plane"></i></button>
        </div>
    </div>

    <button class="chat-toggle" id="chatToggle">
        <i class="fas fa-comments"></i>
    </button>

    <!-- Header ser√° carregado aqui dinamicamente -->
    <div id="header-placeholder"></div>

    <main>
        <!-- Hero Section -->
        <section class="hero">
            <h2>Encontre seu novo melhor amigo</h2>
            <p>Conectamos animais abandonados a lares amorosos. Ajude a fazer a diferen√ßa na vida de um animal de
                estima√ß√£o hoje mesmo.</p>
            <div class="hero-buttons">
                <a href="animais-para-adocao.html" class="btn">Adotar um Animal</a>
                <a href="cadastraranimais.html" class="btn btn-secondary">Cadastrar Animal</a>
            </div>
        </section>

        <!-- Stats Section -->
        <section class="stats-section">
            <div class="stats-container">
                <div class="stat-item">
                    <h3>500+</h3>
                    <p>Animais Adotados</p>
                </div>
                <div class="stat-item">
                    <h3>200+</h3>
                    <p>Fam√≠lias Felizes</p>
                </div>
                <div class="stat-item">
                    <h3>50+</h3>
                    <p>Parceiros</p>
                </div>
                <div class="stat-item">
                    <h3>1000+</h3>
                    <p>Vidas Impactadas</p>
                </div>
            </div>
        </section>

        <!-- Den√∫ncia Section -->
        <section id="report" class="report-section">
            <h2 class="section-title">Denunciar Abandono</h2>
            <p>Se voc√™ encontrou um animal abandonado ou testemunhou maus-tratos, fa√ßa uma den√∫ncia. Sua a√ß√£o pode
                salvar uma vida.</p>

            <div class="emergency-info">
                <h3><i class="fas fa-exclamation-triangle"></i> Emerg√™ncia Animal</h3>
                <p>Se o animal est√° em perigo imediato, entre em contato com as autoridades locais imediatamente.</p>
                <div class="emergency-numbers">
                    <div class="emergency-number">
                        <h4>Pol√≠cia Ambiental</h4>
                        <p>190</p>
                        <a href="tel:190" class="btn btn-emergency">Ligar Agora</a>
                    </div>
                    <div class="emergency-number">
                        <h4>Centro de Controle de Zoonoses</h4>
                        <p>(11) 3397-8900</p>
                        <a href="tel:1133978900" class="btn btn-emergency">Ligar Agora</a>
                    </div>
                    <div class="emergency-number">
                        <h4>Sociedade Protetora dos Animais</h4>
                        <p>(11) 3228-3333</p>
                        <a href="tel:1132283333" class="btn btn-emergency">Ligar Agora</a>
                    </div>
                </div>
            </div>
        </section>

        <!-- Mapa Section -->
        <section id="map" class="map-section">
            <h2 class="section-title">Mapa de Servi√ßos</h2>
            <p>Visualize nosso mapa de sevi√ßos de animais em sua regi√£o.</p>

            <div class="map-container">
                <iframe src="mapa_interativo_completo.html" width="100%" height="600" style="border:0;"
                    allowfullscreen="" loading="lazy">
                </iframe>
            </div>

            <div class="map-instructions">
                <h4><i class="fas fa-info-circle"></i> Como usar o mapa</h4>
                <p>Clique nos marcadores para ver detalhes do endere√ßos de nossos servi√ßos listados.</p>
            </div>
        </section>
    </main>

    <script src="https://www.gstatic.com/firebasejs/8.10.1/firebase-app.js"></script>
    <script src="https://www.gstatic.com/firebasejs/8.10.1/firebase-database.js"></script>
    <script src="https://www.gstatic.com/firebasejs/8.10.1/firebase-auth.js"></script>
    <script src="https://www.gstatic.com/firebasejs/8.10.1/firebase-storage.js"></script>
    <script src="https://unpkg.com/leaflet@1.7.1/dist/leaflet.js"></script>
    <script type="module" src="js/config.js"></script>
    <script type="module" src="js/auth.js"></script>
    <script type="module" src="js/chat.js"></script>
    <!-- <script type="module" src="js/mapa.js"></script> -->

    <script type="module">
        import { injectComponents } from './js/componentes.js';
        injectComponents();
    </script>

    <!-- Script para carregar o header e controlar o dropdown do usu√°rio -->
    <script>

        // Fun√ß√£o para verificar se o usu√°rio est√° logado
        function isUserLoggedIn() {
            return localStorage.getItem('userLoggedIn') === 'true' ||
                localStorage.getItem('user') !== null ||
                sessionStorage.getItem('userLoggedIn') === 'true';
        }

        // Fun√ß√£o para atualizar o dropdown do usu√°rio
        function updateUserDropdown() {
            const dropdown = document.getElementById('userDropdown');
            if (!dropdown) {
                console.log('Dropdown n√£o encontrado, tentando novamente...');
                setTimeout(updateUserDropdown, 100);
                return;
            }

            const isLoggedIn = isUserLoggedIn();

            if (isLoggedIn) {
                dropdown.innerHTML = `
                    <li><a href="meuperfil.html" id="user-link">Meu Perfil</a></li>
                    <li class="separator"></li>
                    <li><a href="#" id="logout-link">Sair</a></li>
                    <li><a href="adm.html" id="admin-link" class="hidden">Admin</a></li>
                `;
            } else {
                dropdown.innerHTML = `
                    <li><a href="login.html">Login</a></li>
                `;
            }

            // Adicionar evento de logout se o usu√°rio estiver logado
            if (isLoggedIn) {
                const logoutLink = document.getElementById('logout-link');
                if (logoutLink) {
                    logoutLink.addEventListener('click', function (e) {
                        e.preventDefault();
                        logout();
                    });
                }
            }
        }

        // Fun√ß√£o de logout
        function logout() {
            localStorage.removeItem('userLoggedIn');
            localStorage.removeItem('user');
            sessionStorage.removeItem('userLoggedIn');
            updateUserDropdown();
            alert('Logout realizado com sucesso!');
            // Opcional: redirecionar para a p√°gina inicial
            // window.location.href = 'index.html';
        }


        // Atualizar o dropdown quando houver mudan√ßas no estado de autentica√ß√£o
        window.addEventListener('storage', function (e) {
            if (e.key === 'userLoggedIn' || e.key === 'user') {
                updateUserDropdown();
            }
        });

        // Atualizar quando a p√°gina ganhar foco
        window.addEventListener('focus', updateUserDropdown);
    </script>
</body>

</html>